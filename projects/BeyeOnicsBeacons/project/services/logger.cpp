////////////////////////////////////////////////////////////////////////////////
//  File name:  logger.cpp
//  Developer:  Yaron Meister
//  Date:       05.04.2019
//  Desciption: An implementation for logger.h
////////////////////////////////////////////////////////////////////////////////

#include "logger.h"     

#include <iostream>     
#include <cstdlib>      
#include <chrono>
#include <ctime> 


////////////////////////////////////////////////////////////////////////////////
//                         Functions Implementations
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
Logger::Logger()
{
  m_file.open("error.log");
}

////////////////////////////////////////////////////////////////////////////////
Logger::~Logger()
{
  m_file.close();
}

////////////////////////////////////////////////////////////////////////////////
void Logger::Write(const char* format, ...)
{
  try
  {
    std::lock_guard<std::mutex> lock(m_mutex);

    auto end = std::chrono::system_clock::now();
    std::time_t end_time = std::chrono::system_clock::to_time_t(end);

    // Writing on file
    m_file << std::ctime(&end_time) << ":  " << format << std::endl;
  }
  catch (...)
  {
    throw LoggerException("Write");
  }
}
